<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="PEDMEMS0000">

<typeAlias alias="resultClass"	type="lcn.module.common.util.HashBox" />
<typeAlias alias="paramClass"	type="lcn.module.common.util.HashBox" />

<!-- EMS Data -->
<select id="TSC_EMS_DATA-SELECT01" parameterClass="map" resultClass="resultClass">
SELECT   TO_CHAR(TO_DATE(A.ORD_DY,'yyyymmdd'),'YYYY-MM-DD') ORD_DY,
         A.VEN_CD, A.ORD_SLIP_CNT, A.ORD_SKU, A.ORD_QTY, A.ORD_AMT,
         B.BUY_QTY, B.BUY_AMT, B.SALE_QTY, B.SALE_AMT, B.SUM_SALE_QTY, B.SUM_SALE_AMT, B.STK_QTY, B.STK_AMT,
         C.BUY_SLIP_CNT, C.BUY_AMT, C.BUY_RTN_SLIP_CNT, C.BUY_RTN_AMT, C.BUY_CHG_SLIP_CNT, C.BUY_CHG_AMT,
         D.USPLY_SLIP_CNT, D.USPLY_SKU, D.USPLY_QTY, D.USPLY_AMT, E.COM_NM
   FROM  TED_ORD_TOTAL    A, 
         TED_STK_TOTAL    B, 
         TED_BUY_TOTAL    C, 
         TED_USPLY_TOTAL  D,
         ( SELECT  TO_CHAR(TO_DATE(BB.SEND_DY,'YYYYMMDD')-1,'YYYYMMDD') SEND_DY
                  ,AA.VENDOR_ID AS VEN_CD
                  ,CC.VENDOR_NM AS COM_NM
            FROM  TED_SUB_SERVICE_USER   AA
                 ,TED_EMS_MSG            BB
                 ,TVE_VENDOR             CC
            WHERE AA.ANX_INFO_CD = BB.ANX_INFO_CD
              AND AA.BMAN_NO     = BB.BMAN_NO
              AND AA.SVC_SEQ     = BB.SVC_SEQ
              AND AA.VENDOR_ID   = CC.VENDOR_ID
              AND AA.VENDOR_ID   = #ven#
              AND AA.BMAN_NO     = #bman#
              AND BB.SEQ         = #seq#  )  E
WHERE   A.ORD_DY = B.STK_DY
AND     A.VEN_CD = B.VEN_CD
AND     A.ORD_DY = C.BUY_DY
AND     A.VEN_CD = C.VEN_CD
AND     A.ORD_DY = D.SPLY_DY
AND     A.VEN_CD = D.VEN_CD
AND     A.ORD_DY = E.SEND_DY
AND     A.VEN_CD = E.VEN_CD
ORDER BY A.VEN_CD
</select>
</sqlMap>
